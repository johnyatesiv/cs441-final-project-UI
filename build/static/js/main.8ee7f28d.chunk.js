(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5513:function(e,t,a){e.exports=a(5945)},5518:function(e,t,a){},5520:function(e,t,a){},5522:function(e,t,a){},5524:function(e,t,a){},5725:function(e,t,a){},5850:function(e,t,a){},5854:function(e,t){},5856:function(e,t){},5890:function(e,t){},5891:function(e,t){},5937:function(e,t,a){},5945:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(39),i=a.n(s),o=(a(5518),a(8)),c=a(9),l=a(11),u=a(10),m=a(12),p=(a(5520),a(40)),h=a.n(p),d=a(73),f=a.n(d),v=a(171),g=a.n(v),O=a(46),y=a.n(O),k=a(41),E=(a(5522),a(5524),a(44)),b=a.n(E),C=a(52),I=a.n(C),j=a(45),w=a.n(j),M=a(86),S=a(167),N=(a(5725),a(120)),R=a.n(N),V=a(85),L=a.n(V),T=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(R.a,{className:"ActiveMenuPopover",anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},open:this.props.open},r.a.createElement(k.c,{className:"CloseButton",onClick:this.props.closeMenu}),r.a.createElement("div",{className:"MenuHeader"},r.a.createElement("h1",null,this.props.restaurantName," Menu")),r.a.createElement("div",{className:"ActiveMenu"},r.a.createElement(h.a,{direction:"row",justify:"flex",alignItems:"flex",spacing:16},this.props.items.map(function(t){return r.a.createElement(A,{key:t.id,item:t,addItemToCart:e.props.addItemToCart,closeMenu:e.props.closeMenu})}))))}}]),t}(r.a.Component),A=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"passItemToAppCart",value:function(){this.props.addItemToCart(this.props.item)}},{key:"getItemInfo",value:function(){return r.a.createElement("span",{className:"MenuItemInfo"},this.props.item.name," ",this.props.item.price.toLocaleString("en-US",{style:"currency",currency:"USD"}))}},{key:"render",value:function(){return r.a.createElement(b.a,{className:"MenuItemCard"},r.a.createElement(w.a,{className:"MenuItemCardContent"},r.a.createElement(I.a,{className:"MenuCardMedia",component:"img",image:this.props.item.image}),r.a.createElement("br",null),this.getItemInfo(),r.a.createElement(L.a,null,r.a.createElement(y.a,{className:"MenuBuyButton",onClick:this.passItemToAppCart.bind(this)},"Order"))))}}]),t}(r.a.Component),P=T,D=function(e){function t(e){var a;Object(o.a)(this,t);var n=(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getCookie("lat"),r=a.getCookie("lng"),s=n||32.9781759,i=r||-117.080604;return a.state={displayMap:!0,selectedRestaurant:!1,displayMenu:!1,activeMenu:[],userLat:s,userLng:i},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getCookie",value:function(e){var t=("; "+document.cookie).split("; "+e+"=");if(2==t.length)return t.pop().split(";").shift()}},{key:"componentWillReceiveProps",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"openMenu",value:function(){this.setState({activeMenu:this.props.restaurants[arguments[0]-1].items})}},{key:"closeMenu",value:function(){this.setState({displayMenu:!1,displayMap:!0})}},{key:"getRestaurants",value:function(){var e=[];for(var t in this.props.restaurants)e.push(this.props.restaurants[t]);return e}},{key:"selectRestaurant",value:function(e){var t=e?this.props.restaurants[e]:this.props.restaurants[arguments[0]-1];this.setState({displayMenu:!0,displayMap:!1,activeMenu:t.items,activeRestaurantName:t.name})}},{key:"render",value:function(){return r.a.createElement("div",{className:"UserRestaurantViewContainer"},r.a.createElement("h1",null,"Restaurants Near You"),this.state.displayMap?r.a.createElement(U,{restaurants:this.getRestaurants(),userLat:this.state.userLat,userLng:this.state.userLng,selectRestaurant:this.selectRestaurant.bind(this)}):"",r.a.createElement(h.a,{className:"UserRestaurantViewGrid",container:!0,direction:"row",justify:"center",alignItems:"center",spacing:40},r.a.createElement(P,{open:this.state.displayMenu,items:this.state.activeMenu,restaurantName:this.state.activeRestaurantName,closeMenu:this.closeMenu.bind(this),addItemToCart:this.props.addItemToCart})))}}]),t}(r.a.Component),U=function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectRestaurant",value:function(){console.log("subselecting restaurant "+arguments[0]),this.props.selectRestaurant(arguments[0])}},{key:"createMarkerLabel",value:function(e){return e.name}},{key:"createMarker",value:function(e){return r.a.createElement(M.Marker,{key:e.id,label:this.createMarkerLabel(e),position:{lat:e.lat,lng:e.lng},onClick:this.selectRestaurant.bind(this,e.id)})}},{key:"addMarkers",value:function(){var e=this,t=[];return this.props.restaurants.forEach(function(a){t.push(e.createMarker(a))}),t}},{key:"loadingGraphic",value:function(){return r.a.createElement("div",{className:"RestaurantMapLoader"},r.a.createElement("img",{src:"https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif"}))}},{key:"render",value:function(){var e=this,t=Object(M.withScriptjs)(Object(M.withGoogleMap)(function(t){return r.a.createElement(M.GoogleMap,{defaultZoom:13,defaultCenter:{lat:e.props.userLat,lng:e.props.userLng}},e.addMarkers())}));return r.a.createElement(t,{className:"RestaurantMap",googleMapURL:"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=AIzaSyD44S3kM5pY8Tae-uz5c6YCd-F7gABvSi0",loadingElement:this.loadingGraphic(),containerElement:r.a.createElement("div",{className:"RestaurantMapContainerElement"}),mapElement:r.a.createElement("div",{className:"RestaurantMapElement"})})}}]),t}(r.a.Component),F=(r.a.Component,D),B=(a(5850),a(299)),G=a.n(B),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},console.log("orders:"),console.log(e.orders),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"getOrderRestaurant",value:function(e){return this.props.restaurants[e.restaurantId]?this.props.restaurants[e.restaurantId]:{}}},{key:"getOrderItems",value:function(e){return[]}},{key:"getOrders",value:function(){var e=[];for(var t in this.props.orders)e.push(this.props.orders[t]);return e.reverse(),e}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"UserOrderViewContainer"},r.a.createElement("h1",null,"Your Orders"),r.a.createElement(h.a,{className:"UserOrderViewGrid",container:!0,direction:"row",justify:"center",alignItems:"center",spacing:40},this.getOrders().map(function(t){return"pending"===t.state?r.a.createElement(H,{key:t.id,order:t,restaurant:e.getOrderRestaurant(t),items:e.getOrderItems(t)}):r.a.createElement(x,{key:t.id,order:t,restaurant:e.getOrderRestaurant(t),items:e.getOrderItems(t)})})))}}]),t}(r.a.Component),q=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"openItemSummary",value:function(e){}},{key:"hashOrderId",value:function(e){return G.a.createHash("md5").update(e.toString()).digest("hex").substr(0,8)}},{key:"orderItemsDisplay",value:function(e){return console.log("items:"),console.log(e),r.a.createElement(h.a,null,e.forEach(function(e){if(e.item)return r.a.createElement(b.a,{styles:{width:"10%"}},r.a.createElement(I.a,null,r.a.createElement("img",{src:e.item.image,alt:e.item.name})),r.a.createElement(w.a,null,e.item.name))}))}},{key:"calculateTotal",value:function(){var e=0;return this.props.order.orderItems.forEach(function(t){t.item&&(e+=t.item.price)}),e.toLocaleString("en-US",{style:"currency",currency:"USD"})}},{key:"total",value:function(){return r.a.createElement("span",null,this.calculateTotal())}},{key:"date",value:function(){return r.a.createElement("span",null,new Date(this.props.order.createdAt).toLocaleString())}},{key:"itemCountDisplay",value:function(){if(this.props.order.orderItems){var e=this.props.order.orderItems.length;return e>1?e+" Items":e+" Item"}return""}},{key:"status",value:function(){return r.a.createElement(y.a,{className:"StatusButton"},this.props.order.status)}}]),t}(r.a.Component),x=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return console.log(this.props),r.a.createElement(b.a,{className:"FulfilledOrderCard"},r.a.createElement(w.a,{className:"OrderCardContent"},r.a.createElement(k.b,{fontSize:"large",className:"LeftIcon"}),r.a.createElement("br",null),r.a.createElement("span",{className:"OrderCardHeader"},this.total(),r.a.createElement("br",null),"from ",this.props.restaurant.name,r.a.createElement("br",null),this.itemCountDisplay())),r.a.createElement(L.a,null))}}]),t}(q),H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,{className:"PendingOrderCard"},r.a.createElement(w.a,{className:"OrderCardContent"},r.a.createElement(k.a,{fontSize:"large",className:"LeftIcon"}),r.a.createElement("br",null),r.a.createElement("span",{className:"OrderCardHeader"},this.total(),r.a.createElement("br",null),"from ",this.props.restaurant.name),r.a.createElement("br",null),this.orderItemsDisplay(this.props.order.orderItems),r.a.createElement("span",{className:"OrderCardData"},"at ",this.date())),r.a.createElement(L.a,null))}}]),t}(q),W=z,_=(a(5937),function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"calculateTotal",value:function(){var e=0;for(var t in this.props.cartItems)e+=this.props.cartItems[t].price*this.props.cartItems[t].quantity;return e.toLocaleString("en-US",{style:"currency",currency:"USD"})}},{key:"removeItem",value:function(e){this.props.removeItemFromCart(e)}},{key:"getItems",value:function(){var e=[];for(var t in this.props.cartItems)e.push(this.props.cartItems[t]);return e}},{key:"render",value:function(){return r.a.createElement(R.a,{className:"Cart",open:this.props.open},r.a.createElement(f.a,{onClick:this.props.close},r.a.createElement(k.c,null)),"Ready to place your order?",r.a.createElement("div",{className:"CartContent"},r.a.createElement(h.a,{container:!0,className:"CartGrid",direction:"column",justify:"left",alignItems:"left",spacing:16},this.getItems().map(function(e){return r.a.createElement(J,{key:e.id,item:e})})),r.a.createElement("div",{className:"CartActions"},r.a.createElement("b",null,"Total:")," ",this.calculateTotal(),r.a.createElement("br",null),r.a.createElement(y.a,{className:"CheckoutButton",onClick:this.props.checkout,styles:{}},"Checkout"))))}}]),t}(r.a.Component)),J=function(e){function t(e){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,{className:"CartItem"},r.a.createElement(w.a,null,r.a.createElement(I.a,{className:"CartItemCardMedia",component:"img",image:this.props.item.image}),this.props.item.quantity," ",this.props.item.name,r.a.createElement("br",null),"$",this.props.item.price*this.props.item.quantity))}}]),t}(r.a.Component),Y=_,$=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleError",value:function(e){this.setState({error:!0})}},{key:"processUser",value:function(e){e.error?this.handleError(e.error):this.setState({user:e})}},{key:"getActiveView",value:function(){return this.props.restaurantViewOpen?this.RestaurantView():this.props.orderViewOpen?this.OrderView():null}},{key:"OrderView",value:function(){return r.a.createElement("div",null,r.a.createElement(W,{user:this.state.user,orders:this.props.orders,restaurants:this.props.restaurants,menus:this.props.menus,open:this.props.orderViewOpen,close:this.props.closeOrderView}),r.a.createElement(Y,{open:this.state.cartOpen,close:this.closeCart,cartItems:this.props.cartItems,removeItemFromCart:this.removeItemFromCart}))}},{key:"RestaurantView",value:function(){return r.a.createElement("div",null,r.a.createElement(F,{user:this.state.user,open:this.props.restaurantViewOpen,close:this.props.closeRestaurantView,restaurants:this.props.restaurants,selectedRestaurant:this.props.selectedRestaurant,menus:this.props.menus,addItemToCart:this.props.addItemToCart,closeCart:this.props.closeCart}),r.a.createElement(Y,{open:this.props.cartOpen,close:this.props.closeCart,cartItems:this.props.cartItems,removeItemFromCart:this.removeItemFromCart,checkout:this.props.checkout}))}},{key:"render",value:function(){return this.getActiveView()}}]),t}(r.a.Component),Z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={isLoggedIn:!1,restaurantViewOpen:!1,orderViewOpen:!1,cartItems:{},restaurants:{},selectedRestaurant:!1,menu:{},orders:{}},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.getGeolocation()}},{key:"mutateState",value:function(e,t){var a={};a[e]=t,this.setState(a)}},{key:"openCart",value:function(){this.setState({cartOpen:!0})}},{key:"closeCart",value:function(){this.setState({cartOpen:!1})}},{key:"openRestaurantView",value:function(){this.closeOrderView(),this.setState({restaurantViewOpen:!0})}},{key:"closeRestaurantView",value:function(){this.setState({restaurantViewOpen:!1})}},{key:"openOrderView",value:function(){this.closeRestaurantView(),this.setState({orderViewOpen:!0})}},{key:"closeOrderView",value:function(){this.setState({orderViewOpen:!1})}},{key:"noViewsOpen",value:function(){return!this.state.restaurantViewOpen&&!this.state.orderViewOpen}},{key:"addItemToCart",value:function(e){if(this.state.selectedRestaurant){if(e.restaurantId!==this.state.selectedRestaurant)return!1}else this.setState({selectedRestaurant:e.restaurantId});var t=this.state.cartItems;t[e.id]?t[e.id].quantity++:(t[e.id]=e,t[e.id].quantity=1),this.setState({cart:t})}},{key:"removeItemFromCart",value:function(e){var t=this.state.cartItems;delete t[e],this.setState({cart:t})}},{key:"clearCart",value:function(){this.setState({cartItems:{}})}},{key:"renderMainMenu",value:function(){return this.state.isLoggedIn?r.a.createElement(K,{openRestaurantView:this.openRestaurantView.bind(this),openOrderView:this.openOrderView.bind(this),openCart:this.openCart.bind(this)}):""}},{key:"getRestaurants",value:function(){var e=this;fetch("https://cs441-api.herokuapp.com/restaurants").then(function(e){return e.json()}).then(function(t){var a={};t.forEach(function(e){a[e.id]=e}),e.setState({restaurants:a}),console.log("Fetched restaurants from API.")}).catch(function(t){e.setState({error:!0,errorDetails:t})})}},{key:"getMenus",value:function(){var e=this;fetch("https://cs441-api.herokuapp.com/menus").then(function(e){return e.json()}).then(function(t){var a={};t.forEach(function(e){a[e.id]=e}),e.setState({menus:a}),console.log("Fetched menus from API.")}).catch(function(t){e.setState({error:!0,errorDetails:t})})}},{key:"getOrders",value:function(){var e=this;fetch("https://cs441-api.herokuapp.com/orders").then(function(e){return e.json()}).then(function(t){var a={};t.forEach(function(e){a[e.id]=e}),e.setState({orders:a}),console.log("Fetched orders from API.")}).catch(function(t){e.setState({error:!0,errorDetails:t})})}},{key:"getGeolocation",value:function(){if(navigator.geolocation)try{navigator.geolocation.getCurrentPosition(function(e){console.log("got geolocation!"),console.log(e),document.cookie="lat="+e.coords.lat+";lng="+e.coords.lng},function(e){console.log(e)},{enableHighAccuracy:!0})}catch(e){console.log(e)}else alert("Geolocation is not supported by this browser!")}},{key:"checkout",value:function(){var e=this;this.setState({selectedRestaurant:!1}),this.closeCart(),fetch("https://cs441-api.herokuapp.com/orders",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:this.createOrderPOSTBody()}).then(function(t){console.log(e.state.cartItems),e.getOrders(),e.openOrderView(),e.clearCart()})}},{key:"createOrderPOSTBody",value:function(){return JSON.stringify({restaurantId:this.state.selectedRestaurant,items:this.state.cartItems})}},{key:"updateEmail",value:function(e){this.setState({email:e.target.value})}},{key:"updatePassword",value:function(e){this.setState({password:e.target.value})}},{key:"login",value:function(){var e=this;fetch("https://cs441-api.herokuapp.com/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:this.createLoginPOSTBody()}).then(function(e){return e.json()}).then(function(t){console.log(t),t.error||!t.token?alert("There was an error logging you in."):e.loadLoggedInUI(t.token)})}},{key:"createLoginPOSTBody",value:function(){return JSON.stringify({email:this.state.email,password:this.state.password})}},{key:"loadLoggedInUI",value:function(e){this.setState({isLoggedIn:!0,token:e}),this.getRestaurants(),this.getMenus(),this.getOrders()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},this.renderMainMenu(),r.a.createElement(h.a,{container:!0,className:"AppGrid"},r.a.createElement("br",null),this.noViewsOpen()?r.a.createElement("div",{className:"LogoContainer"},r.a.createElement("img",{className:"LandingLogo",src:"/foodapp_logo_v3.png",alt:"Foodapp Logo"}),this.state.isLoggedIn?"":r.a.createElement("form",null,r.a.createElement(g.a,{name:"email",placeholder:"Email",onChange:this.updateEmail.bind(this)}),r.a.createElement("br",null),r.a.createElement(g.a,{name:"password",placeholder:"Password",type:"password",onChange:this.updatePassword.bind(this)}),r.a.createElement("br",null),r.a.createElement(y.a,{onClick:this.login.bind(this)},"Login")),r.a.createElement("h4",null,"All images courtesy of Wikimedia")):"",r.a.createElement($,{restaurants:this.state.restaurants,selectedRestaurant:this.state.selectedRestaurant,menus:this.state.menus,orders:this.state.orders,cartItems:this.state.cartItems,mutateParentState:this.mutateState.bind(this),restaurantViewOpen:this.state.restaurantViewOpen,orderViewOpen:this.state.orderViewOpen,addItemToCart:this.addItemToCart.bind(this),closeCart:this.closeCart.bind(this),removeItemFromCart:this.removeItemFromCart.bind(this),cartOpen:this.state.cartOpen,checkout:this.checkout.bind(this)})))}}]),t}(r.a.Component),K=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("nav",{className:"AppNav"},r.a.createElement(f.a,{onClick:this.props.openRestaurantView.bind(this)},r.a.createElement(k.e,null)),r.a.createElement(f.a,{onClick:this.props.openOrderView.bind(this)},r.a.createElement(k.d,null)),r.a.createElement(f.a,{onClick:this.props.openCart.bind(this)},r.a.createElement(k.f,null)))}}]),t}(r.a.Component),Q=Z;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var X=a(72),ee={menuOpen:!1,menuRestaurant:{}},te=Object(X.b)({menu:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee;switch((arguments.length>1?arguments[1]:void 0).type){case"OPEN_MENU":return e.menuOpen=!0,e;case"CLOSE_MENU":return e.menuOpen=!1,e;default:return e}}}),ae=Object(X.c)(te);i.a.render(r.a.createElement(S.a,{store:ae},r.a.createElement(Q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5513,2,1]]]);
//# sourceMappingURL=main.8ee7f28d.chunk.js.map